# BusinessDB - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

Laravel 12 –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π –∏ –∑–∞–∫—É–ø–æ–∫.

**URL –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:** https://businessdb.ru/

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- **Framework:** Laravel 12.x
- **PHP:** 8.2+ (–ª–æ–∫–∞–ª—å–Ω–æ 8.3, –ø—Ä–æ–¥–∞–∫—à–Ω 8.3)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:**
  - **PostgreSQL** - –æ—Å–Ω–æ–≤–Ω–∞—è –ë–î –¥–ª—è Laravel (users, news, ideas, transactions –∏ –¥—Ä.)
  - **Microsoft SQL Server** - –≤–Ω–µ—à–Ω—è—è –ë–î (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: `mssql`, `mssql_cp1251`, `mssql_2020-2026`)
- **Frontend:** Blade templates, Tailwind CSS 3.1, Alpine.js 3.4
- **–°–±–æ—Ä–∫–∞:** Vite 7.x
- **–≠–∫—Å–ø–æ—Ä—Ç:** Maatwebsite Excel 3.1 (–¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ .xlsx)
- **–†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞:** Editor.js (alaminfirdows/laravel-editorjs ^2.3)
- **–ü–ª–∞—Ç–µ–∂–∏:** YooKassa SDK (yoomoney/yookassa-sdk-php ^3.11)

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π:

1. **pgsql** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - PostgreSQL –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü Laravel
   - users, news, ideas, transactions, payments, tariffs, newsletters –∏ –¥—Ä—É–≥–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

2. **mssql** - MS SQL Server –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (UTF-8) –∫ –±–∞–∑–µ business2025
   - –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–Ω–µ—à–Ω–µ–π –ë–î –∫–æ–º–ø–∞–Ω–∏–π –∏ —Ç–µ–∫—É—â–∏—Ö –∑–∞–∫—É–ø–æ–∫
   - –ë–∞–∑–∞: business2025 (–æ—Å–Ω–æ–≤–Ω–∞—è, —Å–æ–¥–µ—Ä–∂–∏—Ç db_companies)

3. **mssql_cp1251** - MS SQL Server —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π CP1251 –∫ –±–∞–∑–µ business2025
   - –î–ª—è —Ä–∞–±–æ—Ç—ã —Å VARCHAR –ø–æ–ª—è–º–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ (–∫–æ–º–ø–∞–Ω–∏–∏, —Ä—É–±—Ä–∏–∫–∏)
   - –ë–∞–∑–∞: business2025 (–æ—Å–Ω–æ–≤–Ω–∞—è, —Å–æ–¥–µ—Ä–∂–∏—Ç db_companies)

4. **mssql_2020 - mssql_2026** - MS SQL Server –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö –ø–æ –≥–æ–¥–∞–º
   - –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞–∫—É–ø–∫–∞–º–∏ (zakupki) –∑–∞ —Ä–∞–∑–Ω—ã–µ –≥–æ–¥—ã
   - –ë–∞–∑—ã: business2020, business2021, business2022, business2023, business2024, business2025, business2026

**‚ö†Ô∏è –í–ê–ñ–ù–û: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î**
- **–¢–∞–±–ª–∏—Ü–∞ –∫–æ–º–ø–∞–Ω–∏–π (db_companies)** –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –¢–û–õ–¨–ö–û –≤ –±–∞–∑–µ **business2025**
- **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏** (db_rubrics, db_subrubrics, db_cities) —Ç–∞–∫–∂–µ –≤ **business2025**
- **–ó–∞–∫—É–ø–∫–∏ (zakupki)** —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≥–æ–¥–∞

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```php
// –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é PostgreSQL)
User::where('email', 'test@example.com')->first();
DB::table('news')->get();

// –î–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏–∑ MS SQL –∏—Å–ø–æ–ª—å–∑—É–µ–º cp1251
// –ö–æ–º–ø–∞–Ω–∏–∏ –í–°–ï–ì–î–ê –≤ business2025
DB::connection('mssql_cp1251')->table('db_companies')...

// –î–ª—è –∑–∞–∫—É–ø–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –ø–æ –≥–æ–¥—É
DB::connection('mssql')->table('zakupki')... // —Ç–µ–∫—É—â–∏–π –≥–æ–¥ (business2025)
DB::connection('mssql_2024')->table('zakupki')... // –∑–∞–∫—É–ø–∫–∏ 2024 –≥–æ–¥–∞
DB::connection('mssql_2023')->table('zakupki')... // –∑–∞–∫—É–ø–∫–∏ 2023 –≥–æ–¥–∞
```

## –û–∫—Ä—É–∂–µ–Ω–∏—è

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (Devilbox)

**–ü—É—Ç—å:** `/home/lexun/devilbox/data/www/businessdb`
**URL:** https://businessdb.dvl.to/
**Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:**
- devilbox-php83-1 (PHP 8.3)
- devilbox-pgsql-1 (PostgreSQL 15)

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL
- Host: pgsql
- Port: 5432
- Database: businessdb
- Username: postgres
- Password: (–ø—É—Å—Ç–æ–π)

### –ü—Ä–æ–¥–∞–∫—à–Ω (Ubuntu Server)

**–°–µ—Ä–≤–µ—Ä:** moon (176.117.212.121)
**SSH:** ssh XBMC (–Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ ~/.ssh/config)
**SSH –∫–ª—é—á:** ~/.ssh/id_smtb
**OS:** Ubuntu (Linux 6.8.0-86-generic)
**–ü—É—Ç—å –ø—Ä–æ–µ–∫—Ç–∞:** /home/alex/businessdb
**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞:** alex
**–ì—Ä—É–ø–ø–∞:** www-data
**–í–µ–±-—Å–µ—Ä–≤–µ—Ä:** Nginx 1.24.0
**PHP:** 8.3.6 (CLI) NTS

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `/etc/nginx/sites-available/businessdb.ru`

**–û—Å–Ω–æ–≤–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã:**
- –î–æ–º–µ–Ω: businessdb.ru, www.businessdb.ru
- Document Root: /home/alex/businessdb/public
- PHP-FPM: —á–µ—Ä–µ–∑ unix socket –∏–ª–∏ TCP
- SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (Let's Encrypt)

#### –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ PHP —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ `apt`:
```bash
sudo apt install php8.3-{cli,fpm,pgsql,pdo,sqlite3,gd,zip,mbstring,xml,curl,sqlsrv,pdo-sqlsrv}
```

**–î—Ä–∞–π–≤–µ—Ä—ã SQL Server –¥–ª—è Linux:**
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ Microsoft —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –ü–∞–∫–µ—Ç—ã: php8.3-sqlsrv, php8.3-pdo-sqlsrv

## –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

### ‚ö†Ô∏è –í–ê–ñ–ù–û–ï –ü–†–ê–í–ò–õ–û –î–õ–Ø CLAUDE CODE

**–ù–ï –≤—ã–ø–æ–ª–Ω—è—Ç—å `git commit` –∏ `git push` –±–µ–∑ —è–≤–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!**

- –¢–æ–ª—å–∫–æ –≤–Ω–æ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ñ–∞–π–ª—ã –ª–æ–∫–∞–ª—å–Ω–æ
- –ö–æ–º–º–∏—Ç—å—Ç–µ –∏ –∑–∞–ª–∏–≤–∞–π—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¢–û–õ–¨–ö–û –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–Ω–æ –ø–æ–ø—Ä–æ—Å–∏—Ç

### Git workflow

1. **–õ–æ–∫–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
   ```bash
   cd /home/lexun/devilbox/data/www/businessdb
   # –í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
   git add .
   git commit -m "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
   git push origin main
   ```

2. **–î–µ–ø–ª–æ–π –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω:**
   ```bash
   ssh XBMC
   cd /home/alex/businessdb
   git pull origin main
   ```

3. **–ï—Å–ª–∏ –Ω—É–∂–Ω—ã composer –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   composer install --no-dev --optimize-autoloader
   ```

4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤:**
   ```bash
   sudo systemctl restart php8.3-fpm
   sudo systemctl reload nginx
   ```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (GitHub Actions)

**–ù–∞—Å—Ç—Ä–æ–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ main –≤–µ—Ç–∫—É:**

1. Workflow –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ GitHub Actions
2. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH
3. –í—ã–ø–æ–ª–Ω—è–µ—Ç `git pull origin main`
4. –í—ã–ø–æ–ª–Ω—è–µ—Ç `php artisan optimize:clear` (–æ—á–∏—â–∞–µ—Ç –≤—Å–µ –∫–µ—à–∏ –≤–∫–ª—é—á–∞—è opcache)
5. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç PHP-FPM: `sudo systemctl restart php8.3-fpm`

**–§–∞–π–ª workflow:** `.github/workflows/deploy.yml`

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –¥–µ–ø–ª–æ—è:**
```bash
gh run list --limit 5
gh run view [run_id]
```

### –í–∞–∂–Ω–æ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

- **–í–°–ï–ì–î–ê** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ git –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π, –ù–ï —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ü—Ä–∏ –∫–æ–º–º–∏—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∞–±–ª–æ–Ω —Å `ü§ñ Generated with Claude Code` –∏ `Co-Authored-By: Claude`
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ `.env` —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ - –æ–Ω –Ω–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ `composer.json` –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `composer install` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- **Opcache:** –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `php artisan optimize:clear`

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Laravel 12

### Middleware –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –í Laravel 11+ –º–µ—Ç–æ–¥ `$this->middleware()` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ **—É–¥–∞–ª–µ–Ω**.

**–ù–ï–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É):**
```php
public function __construct()
{
    $this->middleware('auth'); // ‚ùå –û—à–∏–±–∫–∞!
}
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ routes):**
```php
// routes/web.php
Route::middleware('auth')->group(function () {
    Route::get('/companies', [CompanyController::class, 'index']);
});
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (app/Http/Controllers/)

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã:**

| –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|
| `ZakupkiController` | –ó–∞–∫—É–ø–∫–∏ (–≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞), –ø–æ–¥–¥–µ—Ä–∂–∫–∞ year-based –ë–î, –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| `CompanyController` | –ö–æ–º–ø–∞–Ω–∏–∏ (—Ç–æ–ª—å–∫–æ business2025), —Ç—Ä–µ–±—É–µ—Ç auth |
| `ShopController` | –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω: –∫–∞—Ç–∞–ª–æ–≥, –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ–≤–∞—Ä–∞, –ø–æ–∫—É–ø–∫–∏ |
| `AdminController` | –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∏–¥–µ–∏, SQL, —Ä–∞—Å—Å—ã–ª–∫–∏, –ø–ª–∞—Ç–µ–∂–∏, –∫–µ—à, –º–æ–¥—É–ª–∏ |
| `Admin/TariffController` | CRUD —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤ |
| `NewsController` | –ù–æ–≤–æ—Å—Ç–∏ (—Å Editor.js) |
| `AnnouncementController` | –î–æ—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π (—Å Editor.js, –¥–æ 5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π) |
| `ArticleController` | –°—Ç–∞—Ç—å–∏ (–º–æ–¥—É–ª—å, —Å Editor.js) |
| `IdeasController` | –ò–¥–µ–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `NewsletterController` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏ (–º–æ–¥—É–ª—å, —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É) |
| `TicketController` | –¢–∏–∫–µ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) |
| `AdminTicketController` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞–º–∏ (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤) |
| `PaymentController` | –ü–ª–∞—Ç–µ–∂–∏ –ÆKassa |
| `SubscriptionController` | –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Ç–∞—Ä–∏—Ñ—ã |
| `ProfileController` | –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–≤–∞—Ç–∞—Ä, –∫–æ–Ω—Ç–∞–∫—Ç—ã) |
| `ImageUploadController` | –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è Editor.js |
| `LogController` | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–ª–∏–µ–Ω—Ç–∞ |

### –ú–æ–¥–µ–ª–∏ (app/Models/)

**22 –º–æ–¥–µ–ª–∏:**

| –ú–æ–¥–µ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| `User` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (balance, role, avatar, work_email, work_phone) |
| `Newsletter` | –†–∞—Å—Å—ã–ª–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π |
| `NewsletterKeyword` | –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ |
| `NewsletterLog` | –õ–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–æ–∫ —Ä–∞—Å—Å—ã–ª–æ–∫ |
| `NewsletterSetting` | –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å—Å—ã–ª–æ–∫ (KV storage) |
| `Payment` | –ü–ª–∞—Ç–µ–∂–∏ –ÆKassa |
| `Transaction` | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏) |
| `Tariff` | –¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã |
| `UserSubscription` | –ü–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Ç–∞—Ä–∏—Ñ—ã |
| `TariffHistory` | –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–∞—Ä–∏—Ñ–æ–≤ |
| `News` | –ù–æ–≤–æ—Å—Ç–∏ (—Å Editor.js) |
| `Idea` | –ò–¥–µ–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `Announcement` | –û–±—ä—è–≤–ª–µ–Ω–∏—è (supplier/buyer/dealer, —Å Editor.js) |
| `Article` | –°—Ç–∞—Ç—å–∏ (–º–æ–¥—É–ª—å, —Å Editor.js) |
| `ModuleSetting` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è–º–∏ |
| `Ticket` | –¢–∏–∫–µ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ |
| `TicketMessage` | –°–æ–æ–±—â–µ–Ω–∏—è –≤ —Ç–∏–∫–µ—Ç–∞—Ö |
| `ShopCategory` | –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ (–∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ) |
| `ShopProduct` | –¢–æ–≤–∞—Ä—ã –º–∞–≥–∞–∑–∏–Ω–∞ |
| `ShopProductView` | –ü—Ä–æ—Å–º–æ—Ç—Ä—ã —Ç–æ–≤–∞—Ä–æ–≤ |
| `ShopProductPurchase` | –ü–æ–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ |
| `EmailVerification` | –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è email |

### Artisan –∫–æ–º–∞–Ω–¥—ã (app/Console/Commands/)

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `php artisan newsletters:send` | –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞—Å—Å—ã–ª–æ–∫ —Å –∑–∞–∫—É–ø–∫–∞–º–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º |
| `php artisan newsletters:renew` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É (500‚ÇΩ/–º–µ—Å) |
| `php artisan db:migrate-from-sqlite` | –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ SQLite –≤ PostgreSQL |
| `php artisan db:fix-sequences` | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π PostgreSQL |

### Middleware (app/Http/Middleware/)

| Middleware | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ |
|------------|---------------|
| `CheckModuleEnabled` | `Route::middleware(['module:announcements'])` |
| `EnsureEmailVerified` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ email |
| `EnsurePhoneVerified` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ |

### Helpers (app/Helpers/)

- `DataMaskingHelper` - –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ email, —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤, —Å–∞–π—Ç–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –±–∞–ª–∞–Ω—Å–∞
- `ModuleHelper` - —Ñ—É–Ω–∫—Ü–∏—è `module_enabled($key)` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∫–ª—é—á–µ–Ω–∏—è –º–æ–¥—É–ª—è

### Exports (app/Exports/)

- `CompaniesExport` - —ç–∫—Å–ø–æ—Ä—Ç –∫–æ–º–ø–∞–Ω–∏–π –≤ Excel
- `CompanyExport` - —ç–∫—Å–ø–æ—Ä—Ç –æ–¥–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏
- `ZakupkiExport` - —ç–∫—Å–ø–æ—Ä—Ç –∑–∞–∫—É–ø–æ–∫ –≤ Excel (–º–∞–∫—Å–∏–º—É–º 10,000 –∑–∞–ø–∏—Å–µ–π)
- `NewsletterExport` - —ç–∫—Å–ø–æ—Ä—Ç –∑–∞–∫—É–ø–æ–∫ –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏

## –°–∏—Å—Ç–µ–º–∞ –º–æ–¥—É–ª–µ–π

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º—É –º–æ–¥—É–ª–µ–π, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω–∞/–æ—Ç–∫–ª—é—á–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —á–µ—Ä–µ–∑ `/admin/modules`:

| –ú–æ–¥—É–ª—å | –ö–ª—é—á | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|------|----------|
| –†–∞—Å—Å—ã–ª–∫–∏ | `newsletters` | –†–∞—Å—Å—ã–ª–∫–∏ –∑–∞–∫—É–ø–æ–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º |
| –û–±—ä—è–≤–ª–µ–Ω–∏—è | `announcements` | –î–æ—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π |
| –°—Ç–∞—Ç—å–∏ | `articles` | –°—Ç–∞—Ç—å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| –ò–¥–µ–∏ | `ideas` | –ò–¥–µ–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ä–æ—É—Ç–∞—Ö:**
```php
Route::middleware(['module:announcements'])->group(function () {
    Route::get('/announcements', [AnnouncementController::class, 'index']);
});
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–¥–µ:**
```php
if (module_enabled('newsletters')) {
    // –ú–æ–¥—É–ª—å –≤–∫–ª—é—á–µ–Ω
}
```

## Views (resources/views/)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```
resources/views/
‚îú‚îÄ‚îÄ admin/                  # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ cache.blade.php
‚îÇ   ‚îú‚îÄ‚îÄ ideas.blade.php
‚îÇ   ‚îú‚îÄ‚îÄ modules.blade.php
‚îÇ   ‚îú‚îÄ‚îÄ newsletter-settings.blade.php
‚îÇ   ‚îú‚îÄ‚îÄ newsletters.blade.php
‚îÇ   ‚îú‚îÄ‚îÄ payments.blade.php
‚îÇ   ‚îú‚îÄ‚îÄ sql.blade.php
‚îÇ   ‚îú‚îÄ‚îÄ tickets-index.blade.php
‚îÇ   ‚îú‚îÄ‚îÄ tickets-show.blade.php
‚îÇ   ‚îú‚îÄ‚îÄ users.blade.php
‚îÇ   ‚îî‚îÄ‚îÄ tariffs/            # CRUD —Ç–∞—Ä–∏—Ñ–æ–≤
‚îú‚îÄ‚îÄ announcements/          # –û–±—ä—è–≤–ª–µ–Ω–∏—è (—Å Editor.js)
‚îú‚îÄ‚îÄ articles/               # –°—Ç–∞—Ç—å–∏ (—Å Editor.js)
‚îú‚îÄ‚îÄ auth/                   # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îú‚îÄ‚îÄ companies/              # –ö–æ–º–ø–∞–Ω–∏–∏
‚îú‚îÄ‚îÄ components/             # Blade –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ app-layout.blade.php  # –ì–ª–∞–≤–Ω—ã–π layout
‚îú‚îÄ‚îÄ emails/                 # Email —à–∞–±–ª–æ–Ω—ã
‚îú‚îÄ‚îÄ errors/                 # –°—Ç—Ä–∞–Ω–∏—Ü—ã –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ ideas/                  # –ò–¥–µ–∏
‚îú‚îÄ‚îÄ news/                   # –ù–æ–≤–æ—Å—Ç–∏ (—Å Editor.js)
‚îú‚îÄ‚îÄ newsletters/            # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏
‚îú‚îÄ‚îÄ payments/               # –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
‚îú‚îÄ‚îÄ profile/                # –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ shop/                   # –ú–∞–≥–∞–∑–∏–Ω
‚îú‚îÄ‚îÄ static/                 # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îú‚îÄ‚îÄ subscriptions/          # –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Ç–∞—Ä–∏—Ñ—ã
‚îú‚îÄ‚îÄ tickets/                # –¢–∏–∫–µ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏
‚îî‚îÄ‚îÄ zakupki/                # –ó–∞–∫—É–ø–∫–∏
```

### Layout

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π** layout —Ñ–∞–π–ª:
- `resources/views/components/app-layout.blade.php` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `<x-app-layout>`

–í—Å–µ views –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `<x-app-layout>`, –∞ –Ω–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—É `@extends`.

### –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (resources/views/static/)

- `support.blade.php` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ (Telegram @cdvks, support@businessdb.ru)
- `privacy-policy.blade.php` - –ø–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
- `terms-of-service.blade.php` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ
- `offer.blade.php` - –ø—É–±–ª–∏—á–Ω–∞—è –æ—Ñ–µ—Ä—Ç–∞
- `contacts.blade.php` - –∫–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `tariffs.blade.php` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–∞—Ä–∏—Ñ–∞—Ö

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### MS SQL Server (–≤–Ω–µ—à–Ω—è—è)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö:**

| –ë–∞–∑–∞ | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ |
|------|------------|
| `business2020-2024` | –ó–∞–∫—É–ø–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –≥–æ–¥–∞ |
| `business2025` | **–û—Å–Ω–æ–≤–Ω–∞—è**: –∫–æ–º–ø–∞–Ω–∏–∏ (db_companies) + –∑–∞–∫—É–ø–∫–∏ 2025 |
| `business2026` | –ó–∞–∫—É–ø–∫–∏ 2026 –≥–æ–¥–∞ |

**–¢–∞–±–ª–∏—Ü—ã –≤ business2025:**
- `db_companies` - –∫–æ–º–ø–∞–Ω–∏–∏ (–¢–û–õ–¨–ö–û –∑–¥–µ—Å—å!)
- `db_rubrics` - —Ä—É–±—Ä–∏–∫–∏ –∫–æ–º–ø–∞–Ω–∏–π
- `db_subrubrics` - –ø–æ–¥—Ä—É–±—Ä–∏–∫–∏ –∫–æ–º–ø–∞–Ω–∏–π
- `db_cities` - –≥–æ—Ä–æ–¥–∞
- `zakupki` - –∑–∞–∫—É–ø–∫–∏ 2025 –≥–æ–¥–∞
- `zakupki_specification` - —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–∫—É–ø–æ–∫

### PostgreSQL (–ª–æ–∫–∞–ª—å–Ω–∞—è)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã Laravel:**

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `users` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ |
| `transactions` | –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ |
| `payments` | –ü–ª–∞—Ç–µ–∂–∏ –ÆKassa |
| `tariffs` | –¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã |
| `user_subscriptions` | –ü–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| `tariff_history` | –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ç–∞—Ä–∏—Ñ–æ–≤ |
| `news` | –ù–æ–≤–æ—Å—Ç–∏ |
| `ideas` | –ò–¥–µ–∏ |
| `announcements` | –û–±—ä—è–≤–ª–µ–Ω–∏—è |
| `articles` | –°—Ç–∞—Ç—å–∏ |
| `newsletters` | –†–∞—Å—Å—ã–ª–∫–∏ |
| `newsletter_keywords` | –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ —Ä–∞—Å—Å—ã–ª–æ–∫ |
| `newsletter_logs` | –õ–æ–≥–∏ —Ä–∞—Å—Å—ã–ª–æ–∫ |
| `newsletter_settings` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å—Å—ã–ª–æ–∫ |
| `tickets` | –¢–∏–∫–µ—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏ |
| `ticket_messages` | –°–æ–æ–±—â–µ–Ω–∏—è —Ç–∏–∫–µ—Ç–æ–≤ |
| `shop_categories` | –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ |
| `shop_products` | –¢–æ–≤–∞—Ä—ã |
| `shop_product_views` | –ü—Ä–æ—Å–º–æ—Ç—Ä—ã —Ç–æ–≤–∞—Ä–æ–≤ |
| `shop_product_purchases` | –ü–æ–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ |
| `module_settings` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥—É–ª–µ–π |

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

### .env (–ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

```env
APP_ENV=local
APP_DEBUG=true
APP_URL=https://businessdb.dvl.to

# PostgreSQL (–æ—Å–Ω–æ–≤–Ω–∞—è –ë–î)
DB_CONNECTION=pgsql
DB_HOST=pgsql
DB_PORT=5432
DB_DATABASE=businessdb
DB_USERNAME=postgres
DB_PASSWORD=

# MS SQL Server –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
MSSQL_HOST=172.26.192.1
MSSQL_PORT=1433
MSSQL_DATABASE=buss
MSSQL_USERNAME=sa
MSSQL_PASSWORD=***

# –ÆKassa
YOOKASSA_SHOP_ID=1197477
YOOKASSA_SECRET_KEY=test_***
```

### .env (–ø—Ä–æ–¥–∞–∫—à–Ω)

```env
APP_ENV=production
APP_DEBUG=false
APP_URL=https://businessdb.ru

# PostgreSQL
DB_CONNECTION=pgsql
DB_HOST=localhost
DB_PORT=5432
DB_DATABASE=businessdb
DB_USERNAME=businessdb_user
DB_PASSWORD=***

# MS SQL Server –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
MSSQL_HOST=172.26.192.1
MSSQL_PORT=1433
MSSQL_DATABASE=business2025
MSSQL_USERNAME=sa
MSSQL_PASSWORD=***

# –ÆKassa
YOOKASSA_SHOP_ID=***
YOOKASSA_SECRET_KEY=live_***
```

## –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–í—Å–µ –∞–¥–º–∏–Ω-—Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç—Ä–µ–±—É—é—Ç —Ä–æ–ª—å `admin` –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–µ –º–µ–Ω—é "–ê–¥–º–∏–Ω".

| –°—Ç—Ä–∞–Ω–∏—Ü–∞ | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|----------|
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | `/admin/users` | –ë–∞–ª–∞–Ω—Å, —Ä–æ–ª–∏, —É–¥–∞–ª–µ–Ω–∏–µ |
| –ò–¥–µ–∏ | `/admin/ideas` | –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∏–¥–µ–π |
| –¢–∞—Ä–∏—Ñ—ã | `/admin/tariffs` | CRUD —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤ |
| –ü–ª–∞—Ç–µ–∂–∏ | `/admin/payments` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π –ÆKassa |
| –†–∞—Å—Å—ã–ª–∫–∏ | `/admin/newsletters` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞—Å—Å—ã–ª–æ–∫ |
| –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å—Å—ã–ª–∫–∏ | `/admin/newsletter-settings` | –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã, –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫ |
| SQL –ó–∞–ø—Ä–æ—Å—ã | `/admin/sql` | SELECT –∑–∞–ø—Ä–æ—Å—ã –∫ –ª—é–±–æ–π –ë–î |
| –¢–∏–∫–µ—Ç—ã | `/admin/tickets` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞–º–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ |
| –ö–µ—à | `/admin/cache` | –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ |
| –ú–æ–¥—É–ª–∏ | `/admin/modules` | –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π |

### SQL Admin Panel

**–î–æ—Å—Ç—É–ø:** https://businessdb.ru/admin/sql

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SELECT –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ª—é–±–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –í—ã–±–æ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: pgsql, mssql, mssql_2020-2026, mssql_cp1251
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –º–∞–∫—Å–∏–º—É–º 1000 —Å—Ç—Ä–æ–∫, —Ç–∞–π–º–∞—É—Ç 10 —Å–µ–∫—É–Ω–¥

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
- –†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ SELECT –∑–∞–ø—Ä–æ—Å—ã
- –ë–ª–æ–∫–∏—Ä—É—é—Ç—Å—è: DROP, TRUNCATE, DELETE, UPDATE, INSERT, ALTER, CREATE, GRANT, REVOKE, EXEC

## –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ÆKassa

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `config/services.php`:
```php
'yookassa' => [
    'shop_id' => env('YOOKASSA_SHOP_ID'),
    'secret_key' => env('YOOKASSA_SECRET_KEY'),
],
```

### –ú–æ–¥–µ–ª—å Payment

**–ü–æ–ª—è:**
- `yookassa_payment_id` - ID –ø–ª–∞—Ç–µ–∂–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –ÆKassa (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
- `amount` - —Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞
- `currency` - –≤–∞–ª—é—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é RUB)
- `status` - —Å—Ç–∞—Ç—É—Å (pending, succeeded, canceled)
- `payment_method` - —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã
- `metadata` - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (JSON)
- `paid_at` - –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ–ø–ª–∞—Ç—ã

**–ú–µ—Ç–æ–¥—ã:** `isSucceeded()`, `isPending()`, `isCanceled()`

### –ú–∞—Ä—à—Ä—É—Ç—ã –ø–ª–∞—Ç–µ–∂–µ–π

```php
// –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
Route::post('/payment/create', [PaymentController::class, 'create']);
Route::get('/payment/callback', [PaymentController::class, 'callback']);
Route::get('/payment/history', [PaymentController::class, 'history']);
Route::get('/payment/status/{paymentId}', [PaymentController::class, 'status']);

// Webhook (–ø—É–±–ª–∏—á–Ω—ã–π)
Route::post('/payment/webhook', [PaymentController::class, 'webhook']);
```

### –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –ÆKassa

- –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞: `5555 5555 5555 4477`
- –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞: `5555 5555 5555 5599`
- CVC: –ª—é–±—ã–µ 3 —Ü–∏—Ñ—Ä—ã
- –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: –ª—é–±–∞—è –±—É–¥—É—â–∞—è –¥–∞—Ç–∞

## –°–∏—Å—Ç–µ–º–∞ –º–∞–≥–∞–∑–∏–Ω–∞ (Shop)

### –û–ø–∏—Å–∞–Ω–∏–µ

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ —Ç–æ–≤–∞—Ä–æ–≤ –∏ —É—Å–ª—É–≥ –∑–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –≤–∞–ª—é—Ç—É.

**URL:** https://businessdb.ru/shop

### –¢–∞–±–ª–∏—Ü—ã

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `shop_categories` | –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (parent_id) |
| `shop_products` | –¢–æ–≤–∞—Ä—ã (Editor.js –æ–ø–∏—Å–∞–Ω–∏–µ, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è) |
| `shop_product_views` | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ (IP, User Agent) |
| `shop_product_purchases` | –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ |

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–ª–∞–Ω—Å–æ–º

–ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ —Ç–æ–≤–∞—Ä–∞:
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è DB —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
3. –°–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å
4. –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –ø–æ–∫—É–ø–∫–∏
5. –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ `transactions`
6. –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —Å—á–µ—Ç—á–∏–∫ –ø–æ–∫—É–ø–æ–∫
7. –ö–æ–º–º–∏—Ç–∏—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è

## –°–∏—Å—Ç–µ–º–∞ —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

### –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ —Ç–∏–∫–µ—Ç–æ–≤ –¥–ª—è —Å–≤—è–∑–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.

### –ú–æ–¥–µ–ª—å Ticket

**–ü–æ–ª—è:**
- `ticket_number` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π 10-–∑–Ω–∞—á–Ω—ã–π –Ω–æ–º–µ—Ä
- `phone`, `country_code` - —Ç–µ–ª–µ—Ñ–æ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `subject` - —Ç–µ–º–∞ —Ç–∏–∫–µ—Ç–∞
- `message` - —Å–æ–æ–±—â–µ–Ω–∏–µ
- `status` - —Å—Ç–∞—Ç—É—Å (new, in_progress, closed)
- `closed_at` - –¥–∞—Ç–∞ –∑–∞–∫—Ä—ã—Ç–∏—è

**–ú–µ—Ç–æ–¥—ã:** `generateTicketNumber()`, `isNew()`, `isInProgress()`, `isClosed()`, `getStatusBadgeClass()`, `getStatusName()`

### –ú–æ–¥–µ–ª—å TicketMessage

**–ü–æ–ª—è:**
- `message` - —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- `attachments` - –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (array)

## Editor.js –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Editor.js** (v2.0+) –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤:
- –ù–æ–≤–æ—Å—Ç—è—Ö (News)
- –û–±—ä—è–≤–ª–µ–Ω–∏—è—Ö (Announcement)
- –°—Ç–∞—Ç—å—è—Ö (Article)
- –¢–æ–≤–∞—Ä–∞—Ö –º–∞–≥–∞–∑–∏–Ω–∞ (ShopProduct)

**–ü–∞–∫–µ—Ç:** `alaminfirdows/laravel-editorjs` ^2.3

**–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ Blade:**
```blade
@editorJsRender($content)
```

**–ü–ª–∞–≥–∏–Ω—ã:** Header, List (EditorjsList), SimpleImage, Quote, Delimiter, Table, Checklist, Embed

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "could not find driver" –¥–ª—è MS SQL

**–†–µ—à–µ–Ω–∏–µ (Ubuntu):**
```bash
sudo apt install php8.3-sqlsrv php8.3-pdo-sqlsrv
php -m | grep sqlsrv
sudo systemctl restart php8.3-fpm
```

### –ü—Ä–æ–±–ª–µ–º–∞: "Call to undefined method middleware()"

**–†–µ—à–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç–µ `$this->middleware()` –∏–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ middleware –≤ routes/web.php.

### –ü—Ä–æ–±–ª–µ–º–∞: 504 Gateway Timeout

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ —Ç–∞–±–ª–∏—Ü–∞—Ö zakupki:
- –°–∫—Ä–∏–ø—Ç: `database/sql/create_zakupki_indexes.sql`
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `database/sql/README_INDEXES.md`

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ "trim(): Argument must be of type string, InputBag given"

**–ü—Ä–∏—á–∏–Ω–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `$request->query` –≤–º–µ—Å—Ç–æ `$request->input('query')`

```php
// ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
$query = trim($request->query);

// ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
$query = trim($request->input('query'));
```

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```bash
ssh XBMC
# –∏–ª–∏
ssh -i ~/.ssh/id_smtb alex@176.117.212.121
```

### –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ Laravel
```bash
php artisan optimize:clear  # –û—á–∏—â–∞–µ—Ç –≤—Å–µ –∫–µ—à–∏
```

### –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑ SQLite –≤ PostgreSQL
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
docker exec devilbox-php83-1 php /shared/httpd/businessdb/artisan db:migrate-from-sqlite

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
php artisan db:migrate-from-sqlite /path/to/database.sqlite
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞—Å—Å—ã–ª–æ–∫
```bash
php artisan newsletters:send
php artisan newsletters:send --user_id=1
```

### –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É
```bash
php artisan newsletters:renew
```

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Ä–µ—Å—É—Ä—Å—ã

- **Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/stiapanreha-dev/bdb.php
- **–°–µ—Ä–≤–µ—Ä:** Ubuntu Server "moon" (176.117.212.121)
- **MS SQL Server:** 172.26.192.1:1433

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### Composer (PHP)

**–û—Å–Ω–æ–≤–Ω—ã–µ:**
- laravel/framework ^12.0
- alaminfirdows/laravel-editorjs ^2.3
- doctrine/dbal ^4.3
- maatwebsite/excel ^3.1
- yoomoney/yookassa-sdk-php ^3.11

**Dev:**
- laravel/breeze ^2.3
- phpunit/phpunit ^11.5.3

### NPM (Frontend)

- laravel-vite-plugin ^2.0.0
- vite ^7.0.7
- tailwindcss ^3.1.0
- alpinejs ^3.4.2
- axios ^1.11.0

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 2025-11-25
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–æ–¥–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Å–µ—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞—Ö –∏ –º–æ–¥–µ–ª—è—Ö
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –º–æ–¥—É–ª–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ —Ç–∏–∫–µ—Ç–æ–≤
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏ Laravel (12.x)

### 2025-11-15
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –º–∞–≥–∞–∑–∏–Ω–∞ (Shop)

### 2025-11-07
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

### 2025-11-06
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–æ–¥—É–ª—å —Å—Ç–∞—Ç–µ–π (Articles)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–¥—É–ª—è–º–∏

### 2025-11-02
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Editor.js –≤ –Ω–æ–≤–æ—Å—Ç–∏ –∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è

### 2025-11-01
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –ø–ª–∞—Ç–µ–∂–Ω—ã–π —à–ª—é–∑ –ÆKassa
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—Å—ã–ª–æ–∫

### 2025-10-25
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è —Å SQLite –Ω–∞ PostgreSQL

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-25
